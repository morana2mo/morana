---
title: 属性设置和屏蔽
---
### 冷门知识点

给一个对象设置属性并不仅仅是添加一个新属性或者修改已有的属性值。
obj.foo= 'bar'

如果obj对象中包含名为foo的普通数据访问属性，上述语句只会修改已有的属性值。
如果obj不是直接存在于obj中，[[Prototype]]链就会被遍历，这条连持续找到匹配的属性名，反之foo就会被直接添加到obj上

如果属性名foo既出现在obj中也出现在obj的[[prototype]]链上层，那么就会被屏蔽，obj
中包含的foo属性会屏蔽原型链上层的所有foo属性，因为obj.foo总会选择原型链中最底层的foo属性

分析：如果foo不存在于obj中而是存在原型链上层时，obj.foo= 'bar'的原因？

1，在[[prototype]]链上层存在属性为foo并且没有被标记为只读（writable:false）,会直接在
obj中添加一个名为foo的新属性。它为屏蔽属性（同名属性）
2，在[[prototype]]链上层存在属性为foo并且被标记为只读（writable:false)，那么无法修改已用属性或者在obj创建屏蔽属性。如果运行到严格模式下，代码会抛出一个错误，反之这条赋值语句会被忽略，总之不会发生屏蔽
3，如果在[[prototype]]链上层存在foo并且是个setter,那就一定会调用这个setter,foo不会被添加到obj,也不会重新定义foo这个setter

注：如果也希望第二种和第三种情况下也屏蔽foo,就不能使用=操作符来赋值，而是使用Object.defineProperty(...)来向obj添加foo